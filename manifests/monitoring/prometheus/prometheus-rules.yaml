apiVersion: v1
kind: ConfigMap
metadata:
  name: prometheus-rules
  namespace: monitoring
data:
  wordpress-alerts.yaml: |
    groups:
    - name: wordpress.availability
      rules:
      - alert: WordpressMysqlDown
        expr: absent(up{namespace="wordpress", deployment="mysql"} == 1)
        for: 2m
        labels:
          severity: critical
        annotations:
          summary: "MySQL deployment is not reporting as up"
          description: "Deployment mysql in namespace wordpress has no ready pods for more than 2 minutes."
      - alert: WordpressPhpMyAdminDown
        expr: absent(up{namespace="wordpress", deployment="phpmyadmin"} == 1)
        for: 2m
        labels:
          severity: warning
        annotations:
          summary: "phpMyAdmin deployment is not reporting as up"
          description: "Deployment phpmyadmin in namespace wordpress has no ready pods for more than 2 minutes."
      - alert: WordpressSiteDown
        expr: absent(up{namespace="wordpress", deployment="wordpress"} == 1)
        for: 2m
        labels:
          severity: critical
        annotations:
          summary: "WordPress deployment is not reporting as up"
          description: "Deployment wordpress in namespace wordpress has no ready pods for more than 2 minutes."
